{
  "version": 3,
  "sources": ["../src/utils.ts", "../src/qformvalidate.ts"],
  "sourcesContent": ["// utils.ts\nexport const patterns = {\n  dateOnly: /^[0-9/.-]+$/,\n  digitsOnly: /^[0-9]+$/,\n  floatOnly: /^[0-9.,]+$/,\n  alphaOnly: /^[a-z]+$/i,\n  alphaNumericOnly: /^[a-z0-9]+$/i,\n  urlOnly: /^[a-z0-9.\\-:/?=&#]+$/i,\n  emailOnly: /^[a-z0-9@_\\-+.]+$/i,\n  telOnly: /^[0-9 ()/+]+$/i,\n};\n\nexport function isValidEmail(email: string): boolean {\n  const pattern = /^[_a-z0-9-]+(\\.[_a-z0-9-]+)*@[a-z0-9-]+(\\.[a-z0-9-]+)*\\.[a-z]{2,}$/i;\n  return pattern.test(email);\n}\n\nexport function isValidURL(url: string): boolean {\n  const pattern = /^(https?:\\/\\/)([\\w-]+\\.)+[a-z]{2,}(\\/\\S*)?$/i;\n  return pattern.test(url);\n}\n\nexport function isValidTel(tel: string): boolean {\n  const pattern = /^\\+?[0-9\\s\\-()]{7,15}$/;\n  return pattern.test(tel);\n}\n\nexport function trim(s: string): string {\n  return s.replace(/\\s+/g, ' ').trim();\n}\n", "import { patterns, isValidEmail, isValidURL, isValidTel, trim } from './utils.js';\n\n// Define an interface for the options\nexport interface QFVOptions {\n  scrollTopOffset?: number;\n  defaultErrorMsg: string;\n  defaultErrorMsgSection: string;\n  onSubmitError?: () => void;\n  onSubmitSuccess?: () => void;\n  onFieldError?: (field: FormFieldElement, errorMsg: string) => void;\n  onFieldSuccess?: (field: FormFieldElement) => void;\n  onAfterValidate?: () => void;\n  onBeforeValidate?: () => void;\n}\n\ntype FormFieldElement = HTMLInputElement | HTMLSelectElement | HTMLTextAreaElement;\n\ntype InputTypeRestrictions = 'tel' | 'email' | 'url' | 'number';\nconst typeRestrictions: Record<InputTypeRestrictions, RegExp> = {\n  tel: patterns.telOnly,\n  email: patterns.emailOnly,\n  url: patterns.urlOnly,\n  number: patterns.floatOnly,\n};\n\n/**\n * Validates a form according to QFV rules.\n * @param form - The form element to validate\n * @param options - Optional configuration overrides\n */\n\nexport function qFormValidate(form: HTMLFormElement, options?: QFVOptions): void {\n  // Merge default options with user-provided options\n  const defaults: QFVOptions = {\n    scrollTopOffset: 100,\n    defaultErrorMsg: 'Please complete this field.',\n    defaultErrorMsgSection: 'Please complete this section.',\n    onSubmitError: () => {},\n    onSubmitSuccess: () => {},\n    onFieldError: (field, errorMsg) => {},\n    onFieldSuccess: (field) => {},\n    onAfterValidate: () => {},\n    onBeforeValidate: () => {},\n    ...options, // overwrite defaults with any provided options\n  };\n\n  form.noValidate = true;\n  form.addEventListener('clear', () => clearErrors(form));\n\n  form.addEventListener('submit', (event) => {\n    event.preventDefault();\n    return validateForm(form);\n  });\n\n  const fields = form.querySelectorAll<FormFieldElement>('input, select, textarea');\n  fields.forEach((field) => {\n    watchField(field);\n  });\n\n  \n  /**\n   * Description placeholder\n   *\n   * @param {FormFieldElement} field \n   * @returns {string} \n   */\n\n  function getErrorMsg(field: FormFieldElement): string {\n    if (field.dataset.errorMsg) return field.dataset.errorMsg;\n    if (field instanceof HTMLSelectElement) return 'Please select an option';\n    switch (field.type) {\n      case 'tel':\n        return 'Please enter a valid telephone number';\n      case 'url':\n        return 'Please enter a valid URL.';\n      case 'email':\n        return 'Please enter a valid email address.';\n      case 'password':\n        return 'Please enter a valid password';\n      default:\n        return defaults.defaultErrorMsg;\n    }\n  }\n\n  function addError(field: FormFieldElement): void {\n    const errorMsg = getErrorMsg(field);\n    const parent = field.closest('div, li, p, label');\n    const fieldId = field.id ? `error-${field.id}` : `error-${crypto.randomUUID()}`;\n\n\n    defaults.onFieldError?.(field, errorMsg);\n\n    field.classList.add('error');\n    field.setAttribute('aria-invalid','true');\n    field.setAttribute('aria-describedby', fieldId);\n\n    if (parent) {\n      parent.classList.add('error');\n      parent.querySelector('span.inline-error')?.remove();\n      parent.insertAdjacentHTML(\n        'beforeend',\n        `<span class=\"inline-error\" id=\"${fieldId}\" aria-hidden=\"false\" role=\"alert\">${errorMsg}</span>`,\n      );\n    }\n  }\n\n  function removeFieldError(field: FormFieldElement): void {\n    field.classList.remove('error');\n    field.removeAttribute('aria-invalid');\n    field.removeAttribute('aria-describedby');\n\n    const parent = field.closest('div, li, p, label');\n    if (parent) {\n      parent.classList.remove('error');\n      parent.querySelector('span.inline-error')?.remove();\n    }\n  }\n\n  function watchField(field: FormFieldElement): void {\n    // INPUT, TEXTAREA\n    if (field instanceof HTMLInputElement) {\n      const inputType = field.type as InputTypeRestrictions;\n      if (inputType in typeRestrictions) {\n        const restriction = typeRestrictions[inputType];\n        field.addEventListener('keydown', (event: KeyboardEvent) =>\n          restrictCharacters(field, event, restriction),\n        );\n      }\n      // Using the above bind action, watch the form element\n      ['blur', 'keyup'].forEach((bind) =>\n        field.addEventListener(bind, (event) => {\n          if (event.type === 'blur') {\n            field.value = trim(field.value);\n          }\n          validateField(field, event);\n        }),\n      );\n    }\n\n    // SELECT\n    if (field instanceof HTMLSelectElement) {\n      ['blur', 'change'].forEach((bind) =>\n        field.addEventListener(bind, (event) => {\n          validateField(field, event);\n        }),\n      );\n    }\n  }\n\n  function clearErrors(form: HTMLFormElement): void {\n    const fields = form.querySelectorAll<FormFieldElement>('input, select, textarea');\n    fields.forEach((field) => removeFieldError(field));\n  }\n\n  function restrictCharacters(\n    field: FormFieldElement,\n    event: KeyboardEvent,\n    restrictionType: RegExp,\n  ) {\n    const ignoreKeys = [\n      'ArrowRight',\n      'ArrowLeft',\n      'ArrowUp',\n      'ArrowDown',\n      'Backspace',\n      'Delete',\n      'Tab',\n      'Insert',\n      'Home',\n      'End',\n      'PageUp',\n      'PageDown',\n    ];\n\n    // Ignore the usual keys (Some things to consider altKey, ctrlKey, metaKey or shiftKey)\n    if ((event.key && ignoreKeys.includes(event.key)) || event.ctrlKey || event.metaKey)\n      return true;\n\n    // if they pressed esc... remove focus from field...\n    if (event.key === 'Escape') {\n      field.blur();\n      return false;\n    }\n\n    if (!event.key.match(restrictionType)) {\n      event.preventDefault();\n      return false;\n    }\n  }\n\n  function validateField(field: FormFieldElement, event?: Event) {\n    const validate = event ? event.type !== 'keyup' : true;\n\n    // Only validate on some events so not to show the message too early\n    if (validate) {\n      // Is it a required field\n      if (field.required) {\n        // Select\n        if (field instanceof HTMLSelectElement) {\n          if (field.multiple) {\n            const hasSelection = Array.from(field.options).some(\n              (opt) => opt.selected && opt.value !== '',\n            );\n            if (!hasSelection) {\n              addError(field);\n              return true;\n            }\n          } else {\n            const selectedOption = field.options[field.selectedIndex];\n            if (!selectedOption || selectedOption.value === '') {\n              addError(field);\n              return true;\n            }\n          }\n        }\n\n        // Textarea\n        if (field instanceof HTMLTextAreaElement) {\n          if (field.value === '') {\n            addError(field);\n            return true;\n          }\n        }\n\n        // Input\n        if (field instanceof HTMLInputElement && !['checkbox', 'radio'].includes(field.type)) {\n          if (field.type === 'file') {\n            if (!field.files || field.files.length === 0) {\n              addError(field);\n              return true;\n            }\n          } else {\n            if (field.value === '') {\n              addError(field);\n              return true;\n            }\n          }\n        }\n\n        // Checkbox and radio\n        if (field instanceof HTMLInputElement && ['checkbox', 'radio'].includes(field.type)) {\n          const group = field.form?.querySelectorAll<HTMLInputElement>(\n            `input[name=\"${field.name}\"]`,\n          );\n          if (group && !Array.from(group).some((el) => el.checked)) {\n            addError(field);\n            return true;\n          }\n        }\n      }\n\n      if (field instanceof HTMLInputElement) {\n        // Is it an email field\n        if (field.type == 'email' && field.value !== '' && !isValidEmail(field.value)) {\n          addError(field);\n          return true;\n        }\n\n        // Is it a URL field\n        if (field.type == 'url' && field.value !== '' && !isValidURL(field.value)) {\n          addError(field);\n          return true;\n        }\n\n        // Is it a tel field\n        if (field.type === 'tel' && field.value !== '' && !isValidTel(field.value)) {\n          addError(field);\n          return true;\n        }\n\n        // Does it have a minimum length\n        if (field.dataset.minLength && field.value.length < parseInt(field.dataset.minLength)) {\n          addError(field);\n          return true;\n        }\n\n        // Same as another field\n        if (field.dataset.sameAs) {\n          const sameAs = field.form?.querySelector<HTMLInputElement>(`#${field.dataset.sameAs}`);\n          if (sameAs && sameAs.value != field.value) {\n            addError(field);\n            return true;\n          }\n        }\n\n        // Is it alphaOnly\n        if (field.classList.contains('alpha') && !patterns.alphaOnly.test(field.value)) {\n          addError(field);\n          return true;\n        }\n\n        // Is it alphaNumericOnly\n        if (\n          field.classList.contains('alphanumeric') &&\n          !patterns.alphaNumericOnly.test(field.value)\n        ) {\n          addError(field);\n          return true;\n        }\n      }\n\n      // Is it a password\n      // if ($type == 'password') {\n      //     checkStrength($field);\n      // }\n\n      // $options.onAfterValidate();\n      return false;\n    }\n\n    // No errors, clear any visual messages\n    removeFieldError(field);\n   \n    defaults.onFieldSuccess?.(field);\n  }\n\n  function validateForm(form: HTMLFormElement): boolean {\n    \n    defaults.onBeforeValidate?.();\n\n    let hasError = false;\n    // Clear errors before starting\n    // clearErrors();\n\n    const fields = form.querySelectorAll<FormFieldElement>('input, select, textarea');\n    fields.forEach((field) => {\n      // $options.onBeforeValidate();\n      if (validateField(field)) hasError = true;\n      // $options.onAfterValidate();\n    });\n\n    defaults.onAfterValidate?.();\n    if (!hasError && defaults.onSubmitSuccess) defaults.onSubmitSuccess();\n    if (hasError && defaults.onSubmitError) defaults.onSubmitError();\n\n    return !hasError;\n  }\n}\n"],
  "mappings": "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",
  "names": ["form", "fields"]
}
